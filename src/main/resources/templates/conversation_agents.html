<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Manage Agent</title>
    <style>
        body{font-family:Arial, sans-serif;padding:24px}
        .box{max-width:600px;margin:0 auto;border:1px solid #e5e7eb;border-radius:12px;padding:24px}
        .form-group{margin:16px 0}
        label{display:block;margin-bottom:8px;font-weight:bold}
        .agent-list{max-height:300px;overflow-y:auto;border:1px solid #e5e7eb;border-radius:8px;padding:8px}
        .agent-item{display:flex;align-items:center;padding:8px;border-radius:6px;margin:4px 0;cursor:pointer;transition:background-color 0.15s}
        .agent-item:hover{background:#f9fafb}
        .agent-item.selected{background:#dbeafe;border:1px solid #2563eb}
        .agent-item input[type=radio]{margin-right:8px}
        .agent-info{flex:1}
        .agent-name{font-weight:bold;color:#1f2937}
        .agent-kind{font-size:12px;color:#6b7280}
        .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:16px}
        a.btn,button{padding:8px 16px;border:1px solid #2563eb;border-radius:8px;background:#dbeafe;color:#2563eb;text-decoration:none;cursor:pointer}
        .btn-ghost{border-color:#e5e7eb;background:#fff;color:#374151}
        .info{background:#f0f9ff;border:1px solid #bae6fd;border-radius:8px;padding:12px;margin-bottom:16px;color:#0369a1}
    </style>
    </head>
<body>
<div class="box">
    
    <form th:action="@{'/chat/' + ${conversationId} + '/agents'}" method="post">
        <div class="form-group">
            <label>Chọn agent tham gia</label>
            <div class="agent-list" id="agentList">
                <div class="agent-item" th:each="a: ${allAgents}" 
                     th:class="${'agent-item' + (a.id == currentAgentId ? ' selected' : '')}">
                    <input type="radio" name="agentId" th:value="${a.id}" 
                           th:checked="${a.id == currentAgentId}" />
                    <div class="agent-info">
                        <div class="agent-name" th:text="${a.displayName}">Agent Name</div>
                        <div class="agent-kind" th:text="${a.kind}">Agent Kind</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="actions">
            <a class="btn btn-ghost" th:href="@{'/chat/' + ${conversationId}}">Hủy</a>
            <button type="submit">Xác nhận</button>
        </div>
    </form>
</div>

<script>
  (function(){
    var agentList = document.getElementById('agentList');
    var agentItems = agentList.querySelectorAll('.agent-item');

    function selectAgent(item){
      // Remove selected class from all items
      agentItems.forEach(function(i){ i.classList.remove('selected'); });
      // Add selected class to clicked item
      item.classList.add('selected');
      // Check the radio button
      var radio = item.querySelector('input[type=radio]');
      if (radio) radio.checked = true;
    }

    // Add click handlers to agent items
    agentItems.forEach(function(item){
      item.addEventListener('click', function(e){
        if (e.target.type !== 'radio') {
          selectAgent(item);
        }
      });
    });
  })();
</script>
</body>
</html>